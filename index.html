<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitLife Pro - Final</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root{--p:#00D09C;--s:#1A1A2E;--a:#FF6B6B;--d:#16213E;--c:#0F3460;--t:#EAEAEA}
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
        body{background:var(--d);color:var(--t);min-height:100vh;padding-bottom:90px}
        .screen{display:none;padding:20px}.screen.active{display:block}
        header{background:linear-gradient(135deg,var(--s),var(--c));padding:15px;text-align:center;border-bottom:3px solid var(--p);position:sticky;top:0;z-index:100}
        header h1{font-size:1.2rem;color:var(--p)}
        .card{background:var(--c);border-radius:15px;padding:15px;margin-bottom:15px;box-shadow: 0 4px 6px rgba(0,0,0,0.1)}
        .card h3{color:var(--p);margin-bottom:10px;font-size: 1.1rem; display: flex; align-items: center; gap: 8px}
        .item-row{display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05); align-items: center}
        .qtd{color: var(--a); font-weight: bold; text-align: right}
        .medida-alt{display: block; font-size: 0.75rem; color: #888; font-weight: normal; margin-top: 2px}
        .btn{width:100%;padding:12px;border:none;border-radius:8px;font-weight:600;cursor:pointer;margin-top:8px;transition: 0.2s}
        .btn-primary{background:var(--p);color:var(--d)}
        .btn-sec{background:var(--s);color:var(--t);border:1px solid var(--p)}
        input, select{width:100%;padding:12px;margin:5px 0;border-radius:8px;border:none;background:var(--s);color:var(--t)}
        .nav{position:fixed;bottom:0;left:0;right:0;background:var(--s);display:flex;justify-content:space-around;padding:12px;z-index:100;border-top: 1px solid var(--c)}
        .nav a{color:var(--t);text-align:center;font-size:0.7rem;text-decoration:none;opacity: 0.6; cursor: pointer}
        .nav a.active{color:var(--p);opacity: 1}
        .nav i{display:block;font-size:1.2rem;margin-bottom:3px}
        table{width: 100%; border-collapse: collapse; font-size: 0.8rem; margin-top: 10px}
        th{text-align: left; color: var(--p); padding-bottom: 8px; border-bottom: 2px solid var(--s)}
        td{padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05)}
        #chart{display: flex; align-items: flex-end; gap: 4px; height: 100px; margin-top: 15px; background: #0b1426; padding: 5px; border-radius: 8px}
        .bar{flex: 1; background: var(--p); border-radius: 2px 2px 0 0; position: relative}
    </style>
</head>
<body>

<div id="reg" class="screen active">
    <header><h1>Configurar Perfil</h1></header>
    <div class="card">
        <h3><i class="fas fa-user-edit"></i> Seus Dados</h3>
        <input id="nome" placeholder="Seu nome">
        <input id="peso" type="number" placeholder="Peso (kg)">
        <input id="altura" type="number" placeholder="Altura (cm)">
        <input id="idade" type="number" placeholder="Idade">
        <select id="sexo"><option value="m">Masculino</option><option value="f">Feminino</option></select>
        <select id="atv">
            <option value="1.2">Sedentário (Pouco esforço)</option>
            <option value="1.375">Leve (1-2 dias/semana)</option>
            <option value="1.55">Moderado (3-5 dias/semana)</option>
            <option value="1.725">Intenso (Treino diário)</option>
        </select>
        <select id="obj">
            <option value="perder">Emagrecer</option>
            <option value="manter">Manter Forma</option>
            <option value="ganhar">Ganhar Massa (Hipertrofia)</option>
        </select>
        <select id="local"><option value="casa">Treinar em Casa</option><option value="academia">Ir para Academia</option></select>
        <button class="btn btn-primary" onclick="salvar()">Gerar Plano Completo</button>
    </div>
</div>

<div id="home" class="screen">
    <header><h1>Dashboard</h1></header>
    <div class="card">
        <h3>Evolução de Peso</h3>
        <div id="chart"></div>
        <div style="display:flex; gap:10px; margin-top:10px">
            <input id="novo-peso" type="number" placeholder="Peso atual" style="flex:2">
            <button class="btn btn-primary" onclick="atualizarPeso()" style="margin:0; flex:1">Salvar</button>
        </div>
    </div>
    <div class="card" style="text-align:center">
        <h3 style="justify-content:center">Meta Diária</h3>
        <p id="kcal-meta-txt" style="font-size:1.5rem; font-weight:bold; color:var(--p)">--</p>
    </div>
</div>

<div id="treino_screen" class="screen">
    <header><h1 id="treino-titulo">Treino do Dia</h1></header>
    <div class="card" style="text-align:center">
        <span id="badge-treino" style="background:var(--a); padding:2px 10px; border-radius:10px; font-size:0.8rem">A</span>
        <h2 id="foco-muscular" style="margin:5px 0">Carregando...</h2>
        <div id="timer-display" style="font-size:1.5rem; color:var(--a); font-weight:bold">00:45</div>
        <button class="btn btn-sec" onclick="startTimer()">Intervalo de Descanso</button>
    </div>
    <div id="container-exercicios"></div>
</div>

<div id="dieta_screen" class="screen">
    <header><h1>Dieta & Medidas</h1></header>
    <div id="container-dieta"></div>
</div>

<div id="compras_screen" class="screen">
    <header><h1>Lista de Mercado</h1></header>
    <div class="card">
        <h3><i class="fas fa-shopping-cart"></i> Planejamento</h3>
        <table>
            <thead>
                <tr>
                    <th>Item</th>
                    <th>7 Dias</th>
                    <th>30 Dias</th>
                </tr>
            </thead>
            <tbody id="lista-compras-corpo"></tbody>
        </table>
    </div>
</div>

<nav class="nav" id="menu" style="display:none">
    <a onclick="show('home')" id="n-home"><i class="fas fa-home"></i>Início</a>
    <a onclick="show('treino_screen')" id="n-treino"><i class="fas fa-dumbbell"></i>Treino</a>
    <a onclick="show('dieta_screen')" id="n-dieta"><i class="fas fa-utensils"></i>Dieta</a>
    <a onclick="show('compras_screen')" id="n-compras"><i class="fas fa-shopping-basket"></i>Compras</a>
</nav>

<script>
let u = { historico: [], treinoAtual: 'A' };

const medCaseira = (item, g) => {
    if (item === 'Arroz') return `${Math.ceil(g/35)} colheres de servir`;
    if (item === 'Frango' || item === 'Carne') return `${Math.round(g/100)} palma(s) da mão`;
    if (item === 'Batata') return `${Math.ceil(g/100)} batata média`;
    if (item === 'Pão') return `${Math.round(g/25)} fatias`;
    return "unidade padrão";
};

const DB_TREINO = {
    academia: {
        A: {foco: "Peito, Ombro e Tríceps", ex: [["Supino Reto", "4x10"], ["Elevação Lateral", "3x15"], ["Tríceps Corda", "4x12"]]},
        B: {foco: "Costas e Bíceps", ex: [["Puxada Alta", "4x10"], ["Remada Baixa", "3x12"], ["Rosca Direta", "3x10"]]},
        C: {foco: "Pernas Completo", ex: [["Agachamento", "4x10"], ["Leg Press", "3x15"], ["Extensora", "3x12"]]}
    },
    casa: {
        A: {foco: "Membros Superiores", ex: [["Flexão", "4x Máximo"], ["Mergulho Sofá", "3x15"], ["Prancha", "3x 1min"]]},
        B: {foco: "Costas e Core", ex: [["Superman", "3x15"], ["Abdominal Infra", "4x20"], ["Bicicleta", "3x 1min"]]},
        C: {foco: "Membros Inferiores", ex: [["Agachamento", "4x20"], ["Afundo", "3x12"], ["Elevação Pélvica", "3x20"]]}
    }
};

function salvar() {
    u.nome = document.getElementById('nome').value;
    u.peso = parseFloat(document.getElementById('peso').value);
    u.alt = parseFloat(document.getElementById('altura').value);
    u.idade = parseInt(document.getElementById('idade').value);
    u.sexo = document.getElementById('sexo').value;
    u.atv = parseFloat(document.getElementById('atv').value);
    u.obj = document.getElementById('obj').value;
    u.local = document.getElementById('local').value;
    
    if(!u.nome || !u.peso) return alert("Por favor, preencha o perfil.");
    u.historico.push(u.peso);
    
    const tmb = 10 * u.peso + 6.25 * u.alt - 5 * u.idade + (u.sexo === 'm' ? 5 : -161);
    const gdc = tmb * u.atv;
    u.kcalMeta = Math.round(u.obj === 'perder' ? gdc - 450 : (u.obj === 'ganhar' ? gdc + 300 : gdc));

    document.getElementById('menu').style.display = 'flex';
    document.getElementById('kcal-meta-txt').innerText = u.kcalMeta + " kcal";
    
    gerarDieta();
    gerarTreino();
    desenharGrafico();
    show('home');
}

function gerarDieta() {
    const p = u.peso;
    const prot = Math.round(p * (u.obj === 'ganhar' ? 2.1 : 1.9));
    const carb = Math.round(((u.kcalMeta * 0.4) / 4));
    
    const refeicoes = [
        { t: "Café da Manhã", itens: [{n:"Pão", g:50}, {n:"Ovos", g:2}] },
        { t: "Almoço", itens: [{n:"Arroz", g:Math.round(carb*0.5)}, {n:"Frango", g:Math.round(prot*0.5)}] },
        { t: "Jantar", itens: [{n:"Batata", g:Math.round(carb*0.4)}, {n:"Carne", g:Math.round(prot*0.4)}] }
    ];

    let html = '';
    refeicoes.forEach(r => {
        html += `<div class="card"><h3>${r.t}</h3>`;
        r.itens.forEach(i => {
            html += `
            <div class="item-row">
                <span>${i.n}</span>
                <span class="qtd">${i.g}${i.n==='Ovos'?' un':'g'} <small class="medida-alt">${medCaseira(i.n, i.g)}</small></span>
            </div>`;
        });
        html += `</div>`;
    });
    document.getElementById('container-dieta').innerHTML = html;
    gerarCompras(refeicoes);
}

function gerarCompras(refs) {
    const resumo = [
        { n: "Frango (Peito)", d7: 1.5, d30: 6.0 },
        { n: "Carne Bovina", d7: 1.2, d30: 5.0 },
        { n: "Arroz Cru", d7: 1.0, d30: 4.0 },
        { n: "Ovos", d7: "2 Dúzias", d30: "8 Dúzias" },
        { n: "Batata Doce", d7: 1.5, d30: 6.0 }
    ];

    document.getElementById('lista-compras-corpo').innerHTML = resumo.map(r => `
        <tr>
            <td>${r.n}</td>
            <td class="qtd">${r.d7}${typeof r.d7 === 'number'?'kg':''}</td>
            <td class="qtd">${r.d30}${typeof r.d30 === 'number'?'kg':''}</td>
        </tr>
    `).join('');
}

function gerarTreino() {
    const t = DB_TREINO[u.local][u.treinoAtual];
    document.getElementById('badge-treino').innerText = "TREINO " + u.treinoAtual;
    document.getElementById('foco-muscular').innerText = t.foco;
    document.getElementById('container-exercicios').innerHTML = t.ex.map(e => `
        <div class="card"><div class="item-row"><b>${e[0]}</b><span class="qtd">${e[1]}</span></div></div>
    `).join('');
}

function atualizarPeso() {
    const np = parseFloat(document.getElementById('novo-peso').value);
    if(np) {
        u.historico.push(np);
        u.peso = np;
        const prox = {A:'B', B:'C', C:'A'};
        u.treinoAtual = prox[u.treinoAtual];
        desenharGrafico();
        gerarDieta();
        gerarTreino();
        document.getElementById('novo-peso').value = '';
    }
}

function desenharGrafico() {
    const max = Math.max(...u.historico);
    document.getElementById('chart').innerHTML = u.historico.map(p => `<div class="bar" style="height:${(p/max)*100}%"></div>`).join('');
}

function startTimer() {
    let t = 45;
    const disp = document.getElementById('timer-display');
    const interval = setInterval(() => {
        t--;
        disp.innerText = `00:${t < 10 ? '0'+t : t}`;
        if(t <= 0) { clearInterval(interval); disp.innerText = "VAI!"; }
    }, 1000);
}

function show(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.nav a').forEach(a => a.classList.remove('active'));
    document.getElementById('n-'+id.split('_')[0]).classList.add('active');
}
</script>
</body>
</html>
