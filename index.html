<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitLife Personal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root{--p:#00D09C;--s:#1A1A2E;--a:#FF6B6B;--d:#16213E;--c:#0F3460;--t:#EAEAEA}
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
        body{background:var(--d);color:var(--t);min-height:100vh;padding-bottom:80px}
        .screen{display:none;padding:20px}.screen.active{display:block}
        header{background:linear-gradient(135deg,var(--s),var(--c));padding:15px;text-align:center;border-bottom:3px solid var(--p);position:sticky;top:0;z-index:100}
        header h1{font-size:1.2rem;color:var(--p)}
        .card{background:var(--c);border-radius:15px;padding:15px;margin-bottom:15px}
        .card h3{color:var(--p);margin-bottom:10px}
        input,select{width:100%;padding:12px;margin:5px 0;border-radius:8px;border:2px solid var(--s);background:var(--s);color:var(--t);outline:none}
        .btn{width:100%;padding:12px;border:none;border-radius:8px;font-weight:600;cursor:pointer;margin-top:8px;transition: 0.3s}
        .btn:active{transform: scale(0.98)}
        .btn-primary{background:var(--p);color:var(--d)}
        .btn-sec{background:var(--s);color:var(--t);border:2px solid var(--p)}
        .nav{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--s);justify-content:space-around;padding:12px;z-index:100;border-top: 1px solid var(--c)}
        .nav a{color:var(--t);text-align:center;font-size:0.7rem;opacity:0.6;text-decoration:none;cursor:pointer}
        .nav a.active{color:var(--p);opacity:1}
        .nav i{display:block;font-size:1.2rem;margin-bottom:2px}
        .stats{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
        .stat{background:var(--s);padding:10px;border-radius:8px;text-align:center}
        .stat .n{font-size:1.3rem;font-weight:bold;color:var(--p)}
        .stat .l{font-size:0.7rem;opacity:0.8}
        .pts{background:linear-gradient(135deg,var(--a),#FF8E53);padding:15px;border-radius:12px;text-align:center;margin-bottom:15px;color: white}
        .pts .n{font-size:2rem;font-weight:bold}
        .notif{position:fixed;top:15px;right:15px;background:var(--p);color:var(--d);padding:12px 20px;border-radius:8px;font-weight:bold;transform:translateX(200%);z-index:200;transition: 0.5s ease-out;box-shadow: 0 4px 15px rgba(0,0,0,0.3)}
        .notif.show{transform:translateX(0)}
        #welcome{text-align:center;padding-top:60px}
        .logo{font-size:4.5rem;margin-bottom: 10px}
        #grafico{height:80px;display:flex;align-items:flex-end;gap:5px;margin-top:15px;background: rgba(0,0,0,0.1);padding: 5px;border-radius: 8px}
    </style>
</head>
<body>

<div class="notif" id="notif">ğŸ‰ Conquista!</div>

<div id="welcome" class="screen active">
    <div class="logo">ğŸ’ª</div>
    <h1>FitLife</h1>
    <p style="opacity:0.8;margin-bottom:30px">Seu personal trainer<br>inteligente e personalizado!</p>
    <button class="btn btn-primary" onclick="show('reg')">ComeÃ§ar Agora</button>
    <button class="btn btn-sec" onclick="load()" style="margin-top:12px">JÃ¡ tenho conta</button>
</div>

<div id="reg" class="screen">
    <header><h1>Criar Perfil</h1></header>
    <div class="card">
        <h3>ğŸ“ Seus Dados</h3>
        <input id="nome" placeholder="Seu nome">
        <input id="idade" type="number" placeholder="Idade">
        <input id="peso" type="number" placeholder="Peso atual (kg)">
        <input id="altura" type="number" placeholder="Altura (cm)">
        <select id="sexo"><option value="">Sexo</option><option value="m">Masculino</option><option value="f">Feminino</option></select>
    </div>
    <div class="card">
        <h3>ğŸ¯ Objetivo & Atividade</h3>
        <select id="obj"><option value="perder">Emagrecer</option><option value="manter">Manter Peso</option><option value="ganhar">Ganhar Massa</option></select>
        <select id="ativ">
            <option value="1.2">SedentÃ¡rio (Pouco exercÃ­cio)</option>
            <option value="1.375">Leve (1-3 dias/semana)</option>
            <option value="1.55">Moderado (3-5 dias/semana)</option>
            <option value="1.725">Ativo (6-7 dias/semana)</option>
        </select>
    </div>
    <div class="card">
        <h3>ğŸ½ï¸ Estilo de Vida</h3>
        <select id="dieta_pref"><option value="normal">Dieta Equilibrada</option><option value="lowcarb">Low Carb</option><option value="vegana">Vegana</option></select>
        <select id="treino_pref"><option value="casa">Treinar em Casa</option><option value="academia">Ir para Academia</option></select>
    </div>
    <button class="btn btn-primary" onclick="criar()">Gerar Meu Plano</button>
</div>

<div id="home" class="screen">
    <header><h1>OlÃ¡, <span id="userNameDisplay"></span>!</h1></header>
    <div class="pts">
        <div>Total de ExperiÃªncia</div>
        <div class="n" id="pontos">0</div>
        <div id="streak">ğŸ”¥ 0 dias seguidos</div>
    </div>
    <div class="stats">
        <div class="stat"><div class="n" id="kcal">0</div><div class="l">Kcal Meta</div></div>
        <div class="stat"><div class="n" id="pesoA">0</div><div class="l">Peso Atual</div></div>
        <div class="stat"><div class="n" id="dias">0</div><div class="l">Registros</div></div>
        <div class="stat"><div class="n" id="conq">0</div><div class="l">TrofÃ©us</div></div>
    </div>
    <div class="card">
        <h3>ğŸ“ˆ EvoluÃ§Ã£o de Peso</h3>
        <input id="novoPeso" type="number" placeholder="Novo peso (kg)">
        <button class="btn btn-sec" onclick="salvarPeso()">Atualizar Peso</button>
        <div id="grafico"></div>
    </div>
    <div class="card">
        <h3>ğŸ¯ Desafio DiÃ¡rio</h3>
        <p id="desafio_txt" style="margin-bottom:10px">...</p>
        <button class="btn btn-primary" id="btnDesafio" onclick="fazerDesafio()">Concluir Desafio (+30pts)</button>
    </div>
</div>

<div id="treino_screen" class="screen">
    <header><h1>ğŸ’ª Plano de Treino</h1></header>
    <div class="card">
        <h3 id="localTreino">Local</h3>
        <div id="exercicios"></div>
    </div>
    <button class="btn btn-primary" onclick="finalizarTreino()">Finalizar Treino (+50pts)</button>
</div>

<div id="dieta_screen" class="screen">
    <header><h1>ğŸ¥— Plano Alimentar</h1></header>
    <div class="card">
        <h3>Meta: <span id="kcalDieta">0</span> kcal</h3>
        <div class="stats">
            <div class="stat"><div class="n" id="prot">0g</div><div class="l">ProteÃ­na</div></div>
            <div class="stat"><div class="n" id="carb">0g</div><div class="l">Carboidratos</div></div>
        </div>
    </div>
    <div id="refeicoes"></div>
</div>

<div id="compras_screen" class="screen">
    <header><h1>ğŸ›’ Lista de Compras</h1></header>
    <div class="card"><div id="lista"></div></div>
</div>

<nav class="nav" id="nav">
    <a onclick="show('home')" id="nav-home"><i class="fas fa-home"></i>Home</a>
    <a onclick="show('treino_screen')" id="nav-treino"><i class="fas fa-dumbbell"></i>Treino</a>
    <a onclick="show('dieta_screen')" id="nav-dieta"><i class="fas fa-utensils"></i>Dieta</a>
    <a onclick="show('compras_screen')" id="nav-compras"><i class="fas fa-shopping-cart"></i>Lista</a>
</nav>

<script>
let user = {nome:'', pts:0, streak:0, pesoHistory:[], conq:[], desafioFeito:false, cal:2000};

const listaDesafios = ['Beba 3L de Ã¡gua hoje', 'Caminhada de 20 min', 'Sem refrigerante hoje', 'Comer 2 frutas', 'Dormir antes das 23h', 'Fazer alongamento'];
const excCasa = [['Agachamentos','3x15'],['FlexÃµes','3x10'],['Prancha','3x30s'],['Polichinelos','3x30']];
const excAcademia = [['Supino Reto','4x10'],['Leg Press 45','4x12'],['Puxada Frente','4x10'],['Rosca Direta','3x12']];
const dietasData = {
    normal: [['CafÃ©','PÃ£o integral com ovos'],['AlmoÃ§o','Arroz, feijÃ£o e frango'],['Jantar','Batata doce e patinho']],
    lowcarb: [['CafÃ©','Omelete com queijo'],['AlmoÃ§o','Frango grelhado e brÃ³colis'],['Jantar','SalmÃ£o ou Atum com salada']],
    vegana: [['CafÃ©','Bowl de frutas e aveia'],['AlmoÃ§o','Arroz integral e lentilha'],['Jantar','Tofu grelhado com legumes']]
};
const comprasData = {
    normal: ['Arroz','FeijÃ£o','Frango','Ovos','Alface','PÃ£o Integral'],
    lowcarb: ['Peito de Frango','Carne MoÃ­da','Ovos','Abacate','BrÃ³colis','Azeite'],
    vegana: ['Lentilha','GrÃ£o de Bico','Banana','Aveia','Tofu','Castanhas']
};

function show(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    
    const nav = document.getElementById('nav');
    nav.style.display = (id === 'welcome' || id === 'reg') ? 'none' : 'flex';
    
    // Atualiza classe ativa na navegaÃ§Ã£o
    document.querySelectorAll('.nav a').forEach(a => a.classList.remove('active'));
    const activeNav = document.querySelector(`.nav a[onclick="show('${id}')"]`);
    if(activeNav) activeNav.classList.add('active');

    atualizarDashboard();
}

function notif(msg) {
    const n = document.getElementById('notif');
    n.textContent = msg;
    n.classList.add('show');
    setTimeout(() => n.classList.remove('show'), 3000);
}

function criar() {
    const nome = document.getElementById('nome').value;
    const peso = parseFloat(document.getElementById('peso').value);
    const alt = parseFloat(document.getElementById('altura').value);
    const idade = parseInt(document.getElementById('idade').value);
    const sexo = document.getElementById('sexo').value;
    
    if(!nome || !peso || !alt || !idade) {
        alert('Por favor, preencha todos os dados bÃ¡sicos!');
        return;
    }

    // CÃ¡lculo TMB (Mifflin-St Jeor)
    let tmb = (10 * peso) + (6.25 * alt) - (5 * idade);
    tmb = (sexo === 'm') ? tmb + 5 : tmb - 161;
    
    const fatorAtv = parseFloat(document.getElementById('ativ').value);
    const objetivo = document.getElementById('obj').value;
    
    let calFinal = tmb * fatorAtv;
    if(objetivo === 'perder') calFinal -= 500;
    if(objetivo === 'ganhar') calFinal += 300;

    user = {
        nome: nome,
        pesoHistory: [peso],
        cal: Math.round(calFinal),
        dieta: document.getElementById('dieta_pref').value,
        treino: document.getElementById('treino_pref').value,
        pts: 0,
        streak: 1,
        conq: [],
        desafioFeito: false,
        lastDesafio: new Date().toDateString()
    };

    save();
    gerarPlanos();
    show('home');
    notif('Perfil criado com sucesso! ğŸ’ª');
}

function save() {
    localStorage.setItem('fitlife_data', JSON.stringify(user));
}

function load() {
    const saved = localStorage.getItem('fitlife_data');
    if(saved) {
        user = JSON.parse(saved);
        gerarPlanos();
        show('home');
    } else {
        alert('Nenhum perfil encontrado. Crie um novo!');
        show('reg');
    }
}

function salvarPeso() {
    const p = parseFloat(document.getElementById('novoPeso').value);
    if(p) {
        user.pesoHistory.push(p);
        user.pts += 20;
        document.getElementById('novoPeso').value = '';
        save();
        atualizarDashboard();
        notif('+20 pts por registrar o peso!');
        verificarConquistas();
    }
}

function gerarPlanos() {
    // Treino
    const ex = user.treino === 'casa' ? excCasa : excAcademia;
    document.getElementById('localTreino').innerText = user.treino === 'casa' ? 'ğŸ  Treino em Casa' : 'ğŸ‹ï¸ Treino de Academia';
    document.getElementById('exercicios').innerHTML = ex.map(e => `
        <div style="background:var(--s);padding:12px;margin:8px 0;border-radius:8px;display:flex;justify-content:space-between;align-items:center">
            <span style="font-weight:600">${e[0]}</span>
            <span style="color:var(--p);font-weight:bold;background:var(--d);padding:4px 8px;border-radius:5px">${e[1]}</span>
        </div>
    `).join('');

    // Dieta
    document.getElementById('kcalDieta').innerText = user.cal;
    document.getElementById('prot').innerText = Math.round(user.pesoHistory[user.pesoHistory.length-1] * 2) + 'g';
    document.getElementById('carb').innerText = Math.round((user.cal * 0.45) / 4) + 'g';
    
    const r = dietasData[user.dieta];
    document.getElementById('refeicoes').innerHTML = r.map(x => `
        <div class="card" style="margin-bottom:10px">
            <h4 style="color:var(--p)">${x[0]}</h4>
            <p>${x[1]}</p>
        </div>
    `).join('');

    // Compras
    document.getElementById('lista').innerHTML = comprasData[user.dieta].map(i => `
        <div style="background:var(--s);padding:12px;margin:5px 0;border-radius:8px;border-left:4px solid var(--p)">
            <input type="checkbox" style="width:20px;margin-right:10px"> ${i}
        </div>
    `).join('');

    // Desafio
    if(!user.desafioTxt) gerarNovoDesafio();
    document.getElementById('desafio_txt').innerText = user.desafioTxt;
}

function gerarNovoDesafio() {
    user.desafioTxt = listaDesafios[Math.floor(Math.random() * listaDesafios.length)];
    user.desafioFeito = false;
}

function fazerDesafio() {
    if(!user.desafioFeito) {
        user.pts += 30;
        user.desafioFeito = true;
        save();
        atualizarDashboard();
        notif('Desafio concluÃ­do! +30 pts');
        document.getElementById('btnDesafio').disabled = true;
        document.getElementById('btnDesafio').innerText = "ConcluÃ­do de Hoje";
    }
}

function finalizarTreino() {
    user.pts += 50;
    save();
    show('home');
    notif('Treino finalizado! +50 pts ğŸ’ª');
}

function atualizarDashboard() {
    if(!user.nome) return;
    
    document.getElementById('userNameDisplay').innerText = user.nome;
    document.getElementById('pontos').innerText = user.pts;
    document.getElementById('kcal').innerText = user.cal;
    document.getElementById('pesoA').innerText = user.pesoHistory[user.pesoHistory.length-1] + 'kg';
    document.getElementById('dias').innerText = user.pesoHistory.length;
    document.getElementById('conq').innerText = user.conq.length;
    document.getElementById('streak').innerText = 'ğŸ”¥ ' + user.streak + ' dias seguidos';
    
    if(user.desafioFeito) {
        document.getElementById('btnDesafio').disabled = true;
        document.getElementById('btnDesafio').innerText = "ConcluÃ­do de Hoje";
    }

    // GrÃ¡fico Simples
    const graf = document.getElementById('grafico');
    if(user.pesoHistory.length > 0) {
        const min = Math.min(...user.pesoHistory) - 1;
        const max = Math.max(...user.pesoHistory) + 1;
        const range = max - min || 1;
        
        graf.innerHTML = user.pesoHistory.map(p => {
            const height = ((p - min) / range) * 60 + 10;
            return `<div style="flex:1;background:var(--p);height:${height}px;border-radius:3px 3px 0 0;position:relative" title="${p}kg"></div>`;
        }).join('');
    }
}

function verificarConquistas() {
    let mudou = false;
    if(user.pts >= 100 && !user.conq.includes('iniciante')) {
        user.conq.push('iniciante');
        notif('ğŸŒŸ Bronze: 100 Pontos alcanÃ§ados!');
        mudou = true;
    }
    if(user.pesoHistory.length >= 3 && !user.conq.includes('constante')) {
        user.conq.push('constante');
        notif('ğŸ”¥ Prata: 3 registros de peso!');
        mudou = true;
    }
    if(mudou) save();
}

// InicializaÃ§Ã£o
if(localStorage.getItem('fitlife_data')) {
    load();
}
</script>
</body>
</html>
